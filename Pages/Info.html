<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>√Ä propos - Rafael Antunes Oliveira</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <!-- Ajout de Tailwind CSS pour un meilleur style du chatbot -->
  <script src="https://cdn.tailwindcss.com"></script>

  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&family=Quicksand&display=swap" />
  <link rel="stylesheet" href="../css/style.css" />
  <link rel="stylesheet" href="../css/style4.css" />
  <link rel="stylesheet" href="../css/menu-hamburger.css" />
  
  <style>
    :root {
        --primary-color: #0ff;
        --background-color-dark: #000; 
    }
    
    .chatbot-interface {
        background: #111827;
        border: 1px solid rgba(0, 255, 255, 0.3);
        box-shadow: 0 0 15px rgba(0, 255, 255, 0.1);
        border-radius: 10px;
    }

    .chat-messages {
        scrollbar-width: thin;
        scrollbar-color: var(--primary-color) #1f2937;
    }

    .chat-messages::-webkit-scrollbar {
        width: 8px;
    }

    .chat-messages::-webkit-scrollbar-thumb {
        background-color: var(--primary-color);
        border-radius: 4px;
    }
    
    .message-user {
        background-color: #0c4a6e;
        margin-left: auto;
    }
    .message-bot {
        background-color: #374151;
        margin-right: auto;
    }

    .loading::after {
        content: '...';
        animation: pulse 1s infinite;
    }
    @keyframes pulse {
        0% { opacity: 0.5; }
        50% { opacity: 1; }
        100% { opacity: 0.5; }
    }
    
    body {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      padding-bottom: 140px;
    }
    main {
      flex: 1;
    }
    .main-footer {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      width: 100%;
      z-index: 10;
      margin-top: 0;
    }
    
    #langSelect {
      font-size: clamp(0.8rem, 2vw, 1rem);
      padding: clamp(0.4rem, 1vw, 0.5rem);
    }

    .theme-toggle {
      font-size: clamp(0.8rem, 2vw, 1rem);
      padding: clamp(0.4rem, 1vw, 0.5rem) clamp(0.8rem, 2vw, 1rem);
    }
    
    /* FIX CENTRAGE PHOTO DE PROFIL */
    .profile-pic {
        display: block;
        margin-left: auto;
        margin-right: auto;
    }
    /* FIN FIX CENTRAGE */

    @media (max-width: 480px) {
      #langSelect,
      .theme-toggle {
        font-size: 0.75rem;
        padding: 0.3rem 0.5rem;
      }
    }
  </style>

  <script src="../js/etoile.js" defer></script>
  <script src="../js/script4.js" defer></script>
  <script src="../js/menu-hamburger.js" defer></script>
  <script src="../js/chatbot.js" defer></script>
  <script src="../js/theme.js" defer></script> 
</head>
<body>
  <div class="top-controls">
    <select id="langSelect">
      <option value="fr">Fran√ßais</option>
      <option value="en">English</option>
      <option value="pt">Portugais</option>
    </select>
    <button class="theme-toggle" onclick="toggleTheme()">üé® Th√®me</button>
  </div>

  <div class="navbar">
    <div class="menu-toggle" onclick="toggleMenu(this)">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>

  <nav class="menu" id="mobileMenu">
    <a href="../index.html">Accueil</a>
    <a href="Projets.html">Projets</a>
    <a href="Contact.html">Contact</a>
    <div class="submenu">
      <button class="submenu-toggle">√Ä propos</button>
      <div class="submenu-list">
        <a href="Info.html">Info</a>
        <a href="CV.html">CV</a>
      </div>
    </div>
  </nav>


  <canvas id="stars"></canvas>

  <header>
    <div class="header-left">
      
    </div>
    <div class="header-right">
      <!-- controls moved to top-controls -->
    </div>
  </header>

  <main>
    <div style="text-align: center; margin: 40px auto; padding: 0 20px;">
      <img src="../img/393466355_1037098627324072_6500774992006951921_n.jpg" alt="Rafael Antunes Oliveira" class="profile-pic" style="width: 220px; height: 220px; border-radius: 50%; object-fit: cover; margin-bottom: 20px;">
      <h2>Rafael Antunes Oliveira</h2>
    </div>

    <section class="section" id="section-intro">
      <h3>Introduction</h3>
      <p></p>
    </section>

    <section class="section" id="section-sport">
      <h3>Sport & Karat√©</h3>
      <p></p>
    </section>

    <section class="section" id="section-cinema">
      <h3>Cin√©ma</h3>
      <p></p>
    </section>

    <section class="section" id="section-esport">
      <h3>Esport & Jeux vid√©o</h3>
      <p></p>
    </section>

    <section class="section" id="section-cuisine">
      <h3>Cuisine</h3>
      <p></p>
    </section>

    <section class="section" id="section-motivation">
      <p></p>
    </section>
    
    <!-- Nouvelle structure du Chatbot (avec Tailwind) -->
    <section id="chatbot-section" class="section" style="margin: 40px auto; max-width: 600px;">
        <h3>Pose-moi une question !</h3>
        <div class="chatbot-interface flex flex-col h-[400px]">
            <!-- Zone des messages -->
            <div id="chat-box" class="chat-messages flex flex-col-reverse overflow-y-auto p-4 flex-grow space-y-2">
                <!-- Message de bienvenue (initial) -->
                <div class="message-bot text-white p-3 rounded-xl self-start max-w-[85%]">
                    Salut ! Je suis le chatbot de Rafael. Pose-moi une question sur ses √©tudes, ses projets, ou ses passions !
                </div>
            </div>

            <!-- Formulaire de saisie -->
            <form id="chat-form" class="p-4 flex gap-2 border-t border-gray-700">
                <input 
                    type="text" 
                    id="chat-input" 
                    placeholder="√âcris ici..." 
                    class="flex-grow p-3 rounded-xl bg-gray-800 text-white focus:ring-2 focus:ring-cyan-500 focus:outline-none"
                    autocomplete="off"
                />
                <button 
                    type="submit" 
                    id="send-button"
                    class="px-4 py-3 rounded-xl bg-cyan-600 text-white font-bold hover:bg-cyan-500 disabled:bg-gray-500"
                >
                    Envoyer
                </button>
            </form>
        </div>
    </section>
  </main>
    <footer class="main-footer">
        <div class="max-w-7xl mx-auto">
            &copy; <span id="currentYear"></span> Rafael Antunes Oliveira ‚Äî Tous droits r√©serv√©s
        </div>
    </footer>
    
    <!-- Script d'initialisation et de gestion du Chatbot -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const chatForm = document.getElementById('chat-form');
            const messageInput = document.getElementById('chat-input');
            const chatBox = document.getElementById('chat-box');
            const sendButton = document.getElementById('send-button');

            function appendMessage(text, sender, isLoading = false) {
                const messageElement = document.createElement('div');
                
                messageElement.classList.add('p-3', 'rounded-xl', 'max-w-[85%]', 'text-white', 'shadow-md');
                
                if (sender === 'user') {
                    messageElement.classList.add('message-user', 'self-end');
                } else {
                    messageElement.classList.add('message-bot', 'self-start');
                }
                
                messageElement.innerText = text;

                if (isLoading) {
                    messageElement.classList.add('loading');
                }
                
                if (chatBox) {
                    chatBox.prepend(messageElement);
                    chatBox.scrollTop = 0; 
                }

                return messageElement;
            }

            function updateLoadingMessage(element, finalContent) {
                element.classList.remove('loading');
                element.innerText = finalContent;
            }

            if (chatForm) {
                chatForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const userMessage = messageInput.value.trim();

                    if (userMessage === '') return;

                    sendButton.disabled = true;
                    messageInput.disabled = true;

                    appendMessage(userMessage, 'user');
                    messageInput.value = '';
                    
                    const loadingMessage = appendMessage('', 'bot', true);

                    try {
                        if (typeof handleChatbotQuery === 'undefined') {
                            throw new Error("Erreur: Le script chatbot.js n'a pas √©t√© charg√© ou la fonction est manquante.");
                        }
                        
                        const response = await handleChatbotQuery(userMessage);

                        updateLoadingMessage(loadingMessage, response.response);

                    } catch (error) {
                        console.error("Erreur du Chatbot:", error);
                        updateLoadingMessage(loadingMessage, "Erreur du syst√®me de chat. Voir la console.");
                    } finally {
                        sendButton.disabled = false;
                        messageInput.disabled = false;
                        messageInput.focus();
                    }
                });
                
                messageInput.focus();
            }
        });

        // Restore saved language preference
        const savedLang = localStorage.getItem('lang') || 'fr';
        const langSelect = document.getElementById('langSelect');
        if (langSelect) {
          langSelect.value = savedLang;
          langSelect.addEventListener('change', (e) => {
            localStorage.setItem('lang', e.target.value);
          });
        }

        // Set current year
        const yearEl = document.getElementById('currentYear');
        if (yearEl) yearEl.textContent = new Date().getFullYear();
    </script>
</body>
</html>