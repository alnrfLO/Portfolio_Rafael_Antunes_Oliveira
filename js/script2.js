const translations = {
  fr: {
    navAccueil: "Accueil",
    navProjets: "Projets",
    navContact: "Contact",
    navAPropos: "À propos",
    navInfo: "Info",
    navCV: "CV",
    theme: 'Thème',

    proj1title: "Script Python snake",
    proj1text: "Clicker pour Télécharger un fichier.zip contenant le Snake.",
    proj2title: "Tetris – Projet Python / Pygame",
    proj2text: "Clicker pour Télécharger un fichier.zip contenant le Tetris",
    proj3title: "Script Python Pong",
    proj3text: "Clicker pour Télécharger un fichier.zip contenant le Pong",
    proj4title: "Script Python TicTacToe",
    proj4text: "Clicker pour Télécharger un fichier.zip contenant le TicTacToe.",
    proj5title: "SAE 203 – Développement d'un site web responsive dynamique",
    proj5text: "Site web responsive et accessible réalisé en HTML/CSS/PHP.",
    proj6title: "Jeu en JS",
    proj6text: "Mini-jeu réalisé avec JavaScript.",
    proj7title: "Projet PHP", 
    proj7text: "Projets de développement utilisant PHP.", 

    proj1desc: "Un jeu de serpent classique développé en Python avec Pygame. Le joueur contrôle un serpent qui grandit à chaque nourriture consommée. Le jeu se termine si le serpent se heurte à un mur ou à lui-même.",
    proj2desc: "Dans le cadre d'un projet de spécialité Numérique et Sciences Informatiques (NSI) au lycée, ce travail consistait à développer un jeu Tetris en utilisant exclusivement le langage Python et la bibliothèque Pygame. Le jeu s'intégrait dans un hub de jeux interactif, permettant de lancer différentes applications depuis une interface commune. Ce projet devait être présenté devant un jury, dans le cadre de l'évaluation finale de la spécialité NSI. L'objectif de ce projet était de reproduire le fonctionnement du jeu Tetris (chute des pièces, rotations, détection des lignes complètes), mettre en œuvre une gestion rigoureuse de la logique de jeu et des collisions, utiliser Pygame pour l'affichage graphique et la gestion des entrées clavier, et développer un jeu fluide, stable et jouable, entièrement codé en Python.",
    proj3desc: "Ce projet a été réalisé dans le cadre de la spécialité NSI au lycée et consistait à développer un jeu Pong en Python, à l'aide de la bibliothèque Pygame. Le jeu faisait partie d'un hub centralisé, permettant à l'utilisateur de sélectionner et de lancer différents jeux. Le projet a été évalué lors d'une présentation orale devant un jury. L'objectif principal de ce projet était de implémenter un jeu Pong fonctionnel avec gestion des raquettes, de la balle et du score, travailler la gestion des collisions et des déplacements en temps réel, structurer le code de manière claire et maintenable, et assurer une expérience de jeu simple, fluide et responsive aux entrées utilisateur.",
    proj4desc: "Le jeu du Morpion (Tic-Tac-Toe) en Python. Jouez contre l'ordinateur avec une intelligence artificielle simple. C'est un projet pédagogique pour apprendre les algorithmes de base.",
    proj5desc: "Dans le cadre de la SAE 203 du BUT Métiers du Multimédia et de l'Internet (MMI), il a été demandé de concevoir et développer un site web dynamique et entièrement responsive, en mobilisant les compétences acquises en développement web et en gestion de bases de données. Le projet reposait sur un tirage au sort d'un sujet, imposant à chaque étudiant de s'adapter à une thématique imposée. Cette contrainte visait à reproduire une situation professionnelle réaliste, où le développeur doit répondre à un besoin précis sans choisir lui-même le domaine du projet. Le sujet attribué pour ce projet était les divisions égyptiennes, nécessitant un travail de recherche, de structuration de contenu et de modélisation de données adaptées à cette thématique. L'objectif principal était de réaliser un site web responsive, dynamique et fonctionnel, capable d'afficher et gérer des contenus dynamiques, d'interagir avec une base de données MySQL, d'exploiter un back-end en PHP pour la gestion des données, et d'assurer une navigation fluide sur tous les supports.",
    proj6desc: "Un mini-jeu interactif créé avec JavaScript vanilla. Testez vos réflexes et essayez de battre le meilleur score. Code moderne et optimisé.",
    proj7desc: "Description détaillée du projet PHP.", 

    modalDownload: "Télécharger",
    modalVisit: "Visiter",
    modalClose: "Fermer",
    
    allRightsReserved: "Tous droits réservés",
    footerMentions: "Mentions Légales"
  },
  en: {
    navAccueil: "Home",
    navProjets: "Projects",
    navContact: "Contact",
    navAPropos: "About",
    navInfo: "Info",
    navCV: "CV",
    theme: 'Theme',

    proj1title: "Python Snake Script",
    proj1text: "Click to download a .zip file containing the Snake game.",
    proj2title: "Tetris – Python / Pygame Project",
    proj2text: "Click to download a .zip file containing the Tetris game.",
    proj3title: "Python Pong Script",
    proj3text: "Click to download a .zip file containing the Pong game.",
    proj4title: "Python TicTacToe Script",
    proj4text: "Click to download a .zip file containing the TicTacToe game.",
    proj5title: "SAE 203 – Development of a Dynamic Responsive Website",
    proj5text: "Responsive and accessible site made with HTML/CSS/PHP.",
    proj6title: "JS Game",
    proj6text: "Mini-game made with JavaScript.",
    proj7title: "PHP Project", 
    proj7text: "Development projects using PHP.", 


    proj1desc: "A classic Snake game developed in Python with Pygame. The player controls a snake that grows with each food eaten. The game ends if the snake hits a wall or itself.",
    proj2desc: "As part of a Digital and Computer Science (NSI) specialty project in high school, this work involved developing a Tetris game using exclusively the Python language and the Pygame library. The game was integrated into an interactive game hub, allowing different applications to be launched from a common interface. This project had to be presented to a jury as part of the final evaluation of the NSI specialty. The objective of this project was to reproduce the functioning of the Tetris game (piece falling, rotations, detection of complete lines), implement rigorous management of game logic and collisions, use Pygame for graphic display and keyboard input management, and develop a smooth, stable and playable game, entirely coded in Python.",
    proj3desc: "This project was carried out as part of the NSI specialty in high school and involved developing a Pong game in Python using the Pygame library. The game was part of a centralized hub, allowing the user to select and launch different games. The project was evaluated during an oral presentation before a jury. The main objective of this project was to implement a functional Pong game with management of paddles, ball and score, work on collision management and real-time movements, structure the code in a clear and maintainable way, and ensure a simple, smooth and responsive gaming experience to user inputs.",
    proj4desc: "Tic-Tac-Toe in Python. Play against the computer with a simple AI. This is an educational project to learn basic algorithms.",
    proj5desc: "As part of the SAE 203 of the BUT Multimedia and Internet Professions (MMI) degree, we were asked to design and develop a dynamic and fully responsive website, mobilizing the skills acquired in web development and database management. The project was based on a random draw of a subject, imposing on each student to adapt to an imposed theme. This constraint aimed to replicate a realistic professional situation, where the developer must meet a specific need without choosing the project domain themselves. The subject assigned for this project was Egyptian divisions, requiring research work, content structuring and data modeling adapted to this theme. The main objective of this SAE was to create a responsive, dynamic and functional website, capable of displaying and managing dynamic content, interacting with a MySQL database, leveraging a PHP back-end for data management, and ensuring smooth navigation across all platforms.",
    proj6desc: "An interactive mini-game created with vanilla JavaScript. Test your reflexes and try to beat the high score. Modern and optimized code.",
    proj7desc: "Detailed description of the PHP project.", 

    modalDownload: "Download",
    modalVisit: "Visit",
    modalClose: "Close",
    
    allRightsReserved: "All rights reserved",
    footerMentions: "Legal Notice"
  },
  pt: {
    navAccueil: "Início",
    navProjets: "Projetos",
    navContact: "Contato",
    navAPropos: "Sobre",
    navInfo: "Info",
    navCV: "CV",
    theme: 'Tema',

    proj1title: "Script Python Snake",
    proj1text: "Clique para baixar um arquivo .zip contendo o jogo Snake.",
    proj2title: "Tetris – Projeto Python / Pygame",
    proj2text: "Clique para baixar um arquivo .zip contendo o jogo Tetris.",
    proj3title: "Script Python Pong",
    proj3text: "Clique para baixar um arquivo .zip contendo o jogo Pong.",
    proj4title: "Script Python TicTacToe",
    proj4text: "Clique para baixar um arquivo .zip contendo o jogo TicTacToe.",
    proj5title: "SAE 203 – Desenvolvimento de um Site Responsivo Dinâmico",
    proj5text: "Site responsivo e acessível feito com HTML/CSS/PHP.",
    proj6title: "Jogo JS",
    proj6text: "Mini-jogo feito com JavaScript.",
    proj7title: "Projeto PHP", 
    proj7text: "Projetos de desenvolvimento usando PHP.", 

    proj1desc: "Um jogo clássico de Snake desenvolvido em Python com Pygame. O jogador controla uma cobra que cresce a cada comida consumida. O jogo termina se a cobra bater em uma parede ou em si mesma.",
    proj2desc: "Como parte de um projeto de especialidade em Informática e Ciências Digitais (NSI) no ensino médio, este trabalho consistiu em desenvolver um jogo Tetris usando exclusivamente a linguagem Python e a biblioteca Pygame. O jogo foi integrado em um hub de jogos interativo, permitindo iniciar diferentes aplicações a partir de uma interface comum. Este projeto deveria ser apresentado a um júri como parte da avaliação final da especialidade NSI. O objetivo deste projeto era reproduzir o funcionamento do jogo Tetris (queda de peças, rotações, detecção de linhas completas), implementar uma gestão rigorosa da lógica do jogo e das colisões, usar Pygame para exibição gráfica e gerenciamento de entrada do teclado, e desenvolver um jogo suave, estável e jogável, totalmente codificado em Python.",
    proj3desc: "Este projeto foi realizado como parte da especialidade NSI no ensino médio e consistia em desenvolver um jogo Pong em Python usando a biblioteca Pygame. O jogo fazia parte de um hub centralizado, permitindo ao usuário selecionar e iniciar diferentes jogos. O projeto foi avaliado durante uma apresentação oral perante um júri. O objetivo principal deste projeto era implementar um jogo Pong funcional com gerenciamento de raquetes, bola e pontuação, trabalhar no gerenciamento de colisões e movimentos em tempo real, estruturar o código de forma clara e mantível, e garantir uma experiência de jogo simples, suave e responsiva às entradas do usuário.",
    proj4desc: "O jogo da velha (Tic-Tac-Toe) em Python. Jogue contra o computador com uma IA simples. É um projeto educacional para aprender algoritmos básicos.",
    proj5desc: "Como parte do SAE 203 do Curso de Tecnologia em Multimídia e Internet (MMI), foi solicitado o design e desenvolvimento de um site web dinâmico e totalmente responsivo, mobilizando as habilidades adquiridas em desenvolvimento web e gerenciamento de bases de dados. O projeto foi baseado em um sorteio de um tema, impondo a cada estudante se adaptar a um tema imposto. Essa restrição visava replicar uma situação profissional realista, onde o desenvolvedor deve atender uma necessidade específica sem escolher o domínio do projeto. O tema atribuído para este projeto foi divisões egípcias, exigindo trabalho de pesquisa, estruturação de conteúdo e modelagem de dados adaptadas a este tema. O objetivo principal deste SAE era criar um site responsivo, dinâmico e funcional, capaz de exibir e gerenciar conteúdo dinâmico, interagir com uma base de dados MySQL, aproveitar um back-end PHP para gerenciamento de dados, e garantir navegação suave em todas as plataformas.",
    proj6desc: "Um mini-jogo interativo criado com JavaScript vanilla. Teste seus reflexos e tente bater o recorde. Código moderno e otimizado.",
    proj7desc: "Descrição detalhada do projeto PHP.", 

    modalDownload: "Baixar",
    modalVisit: "Visitar",
    modalClose: "Fechar",
    
    allRightsReserved: "Todos os direitos reservados",
    footerMentions: "Aviso Legal"
  },
  es: {
    navAccueil: "Inicio",
    navProjets: "Proyectos",
    navContact: "Contacto",
    navAPropos: "Acerca de",
    navInfo: "Info",
    navCV: "CV",
    theme: 'Tema',

    proj1title: "Script Python Snake",
    proj1text: "Haga clic para descargar un archivo .zip que contiene el juego Snake.",
    proj2title: "Tetris – Proyecto Python / Pygame",
    proj2text: "Haga clic para descargar un archivo .zip que contiene el juego Tetris.",
    proj3title: "Script Python Pong",
    proj3text: "Haga clic para descargar un archivo .zip que contiene el juego Pong.",
    proj4title: "Script Python TicTacToe",
    proj4text: "Haga clic para descargar un archivo .zip que contiene el juego TicTacToe.",
    proj5title: "SAE 203 – Desarrollo de un Sitio Web Responsivo Dinámico",
    proj5text: "Sitio responsive y accesible hecho con HTML/CSS/PHP.",
    proj6title: "Juego JS",
    proj6text: "Mini-juego hecho con JavaScript.",
    proj7title: "Proyecto PHP", 
    proj7text: "Proyectos de desarrollo usando PHP.",

    proj1desc: "Un juego clásico de Snake desarrollado en Python con Pygame. El jugador controla una serpiente que crece con cada comida consumida. El juego termina si la serpiente choca con una pared o consigo misma.",
    proj2desc: "Como parte de un proyecto de especialidad en Informática y Ciencias Digitales (NSI) en la escuela secundaria, este trabajo consistía en desarrollar un juego Tetris utilizando exclusivamente el lenguaje Python y la biblioteca Pygame. El juego se integró en un hub de juegos interactivo, permitiendo lanzar diferentes aplicaciones desde una interfaz común. Este proyecto debía ser presentado ante un jurado como parte de la evaluación final de la especialidad NSI. El objetivo de este proyecto era reproducir el funcionamiento del juego Tetris (caída de piezas, rotaciones, detección de líneas completas), implementar una gestión rigurosa de la lógica del juego y las colisiones, utilizar Pygame para la visualización gráfica y la gestión de entrada del teclado, y desarrollar un juego suave, estable y jugable, completamente codificado en Python.",
    proj3desc: "Este proyecto se realizó como parte de la especialidad NSI en la escuela secundaria e implicaba desarrollar un juego Pong en Python utilizando la biblioteca Pygame. El juego era parte de un hub centralizado, permitiendo al usuario seleccionar e iniciar diferentes juegos. El proyecto fue evaluado durante una presentación oral ante un jurado. El objetivo principal de este proyecto era implementar un juego Pong funcional con gestión de raquetas, bola y puntuación, trabajar en la gestión de colisiones y movimientos en tiempo real, estructurar el código de forma clara y mantenible, y garantizar una experiencia de juego simple, suave y receptiva a las entradas del usuario.",
    proj4desc: "El juego del Gato (Tic-Tac-Toe) en Python. Juega contra la computadora con una IA simple. Es un proyecto educativo para aprender algoritmos básicos.",
    proj5desc: "Como parte del SAE 203 del Grado de Tecnología en Multimedia e Internet (MMI), se solicitó diseñar y desarrollar un sitio web dinámico y completamente responsivo, movilizando las habilidades adquiridas en desarrollo web y gestión de bases de datos. El proyecto se basaba en un sorteo de un tema, imponiendo a cada estudiante adaptarse a un tema asignado. Esta restricción tenía como objetivo replicar una situación profesional realista, donde el desarrollador debe satisfacer una necesidad específica sin elegir el dominio del proyecto. El tema asignado para este proyecto fueron las divisiones egipcias, requiriendo trabajo de investigación, estructuración de contenido y modelado de datos adaptados a este tema. El objetivo principal de este SAE era crear un sitio web responsivo, dinámico y funcional, capaz de mostrar y gestionar contenido dinámico, interactuar con una base de datos MySQL, aprovechar un back-end PHP para la gestión de datos, y garantizar navegación fluida en todas las plataformas.",
    proj6desc: "Un mini-juego interactivo creado con JavaScript vanilla. Prueba tus reflejos e intenta batir la puntuación más alta. Código moderno y optimizado.",
    proj7desc: "Descripción detallada del proyecto PHP.",

    modalDownload: "Descargar",
    modalVisit: "Visitar",
    modalClose: "Cerrar",
    
    allRightsReserved: "Todos los derechos reservados",
    footerMentions: "Aviso Legal"
  }
};


const projectDetails = {
  // ⚠️ IMPORTANT: Images doivent être en 1280×720px minimum (ratio 16:9)
  // Elles seront automatiquement redimensionnées sans distortion avec object-fit: cover
  1: { images: ["../img/snake.png", "../img/snake.png", "../img/snake.png"], languages: ["Python", "Pygame"], download: "../downloads/snake.zip" },
  2: { images: ["../img/tetris.png", "../img/tetris.png", "../img/tetris.png"], languages: ["Python", "Pygame"], download: "../downloads/Tetris.zip" },
  3: { images: ["../img/pong.png", "../img/pong.png", "../img/pong.png"], languages: ["Python", "Pygame"], download: "../downloads/Pong.zip" },
  4: { images: ["../img/tictactoe.png", "../img/tictactoe.png", "../img/tictactoe.png"], languages: ["Python"], download: "../downloads/TicTacToe.zip" },
  5: { images: ["../img/SAE203.png", "../img/SAE203.png", "../img/SAE203.png"], languages: ["HTML", "CSS", "PHP","MySQL"], link: "http://81.194.40.26/~antunes--oliveira/SAE203/" },
  6: { images: ["../img/jeu-js.png", "../img/jeu-js.png", "../img/jeu-js.png"], languages: ["JavaScript", "HTML", "CSS"], link: "../projets/jeu-js.html" },
  7: { images: ["../img/php_project.png", "../img/php_project.png", "../img/php_project.png"], languages: ["PHP","CSS"], link: "../projets/" } 
};


// Variables d'état du carrousel
let currentSlideIndex = 0;
let currentProjectId = null;


// ===================================================================
// LOGIQUE DE TRADUCTION ET D'AFFICHAGE DU TEXTE
// ===================================================================

function applyText(lang) {
  const t = translations[lang] || translations.fr;
  const currentUrl = window.location.href;

  // Mise à jour des textes des projets sur la carte
  for (let i = 1; i <= 7; i++) {
    const card = document.querySelector(`.project-card[data-project-id="${i}"]`);
    if (card) {
      card.querySelector('h3').textContent = t[`proj${i}title`];
      card.querySelector('p').textContent = t[`proj${i}text`];
      
      // Mise à jour de la description pour l'accessibilité
      card.dataset.description = t[`proj${i}desc`]; 
    }
  }

  // Mise à jour des textes génériques (navigation, pied de page)
  document.querySelectorAll('[data-translate]').forEach(el => {
    const key = el.getAttribute('data-translate');
    if (t[key]) {
      el.textContent = t[key];
    }
  });

  // Mise à jour du bouton de la modale pour la langue
  const actionBtn = document.getElementById('modalActionBtn');
  if (actionBtn) {
      if (actionBtn.dataset.action === 'download') {
          actionBtn.textContent = t.modalDownload;
      } else if (actionBtn.dataset.action === 'link') {
          actionBtn.textContent = t.modalVisit;
      }
  }
}

// ===================================================================
// LOGIQUE DU CARROUSEL
// ===================================================================

function showSlides(n) {
    const details = projectDetails[currentProjectId];
    const images = details ? details.images : [];
    const slidesContainer = document.getElementById('slides-container');
    const dotsContainer = document.getElementById('dot-container');

    if (!images || images.length === 0) {
        slidesContainer.innerHTML = '';
        dotsContainer.innerHTML = '';
        return;
    }

    if (n > images.length - 1) {
        currentSlideIndex = 0;
    }
    if (n < 0) {
        currentSlideIndex = images.length - 1;
    }

    // Affichage des slides par transformation
    // Le slidesContainer DOIT avoir la largeur totale de TOUTES les slides (e.g., 300% pour 3 slides)
    slidesContainer.style.transform = `translateX(-${currentSlideIndex * 100}%)`;

    // Mise à jour des points
    dotsContainer.innerHTML = '';
    for (let i = 0; i < images.length; i++) {
        const dot = document.createElement('span');
        dot.className = 'dot';
        if (i === currentSlideIndex) {
            dot.classList.add('active');
        }
        // Utilisation de i pour naviguer directement au slide
        dot.onclick = () => showSlides(i); 
        dotsContainer.appendChild(dot);
    }
}

function plusSlides(n) {
    // n doit être -1 ou 1
    currentSlideIndex += n;
    showSlides(currentSlideIndex);
}

function closeModal() {
    document.getElementById('projectModal').classList.remove('active');
}

function handleModalAction() {
    const btn = document.getElementById('modalActionBtn');
    const link = btn.dataset.link;
    if (link) {
        if (btn.dataset.action === 'download') {
            // Création d'un lien temporaire pour forcer le téléchargement
            const a = document.createElement('a');
            a.href = link;
            a.download = ''; // force le navigateur à télécharger
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        } else if (btn.dataset.action === 'link') {
            window.open(link, '_blank'); // Ouvrir dans un nouvel onglet
        }
    }
}

// ===================================================================
// LOGIQUE D'OUVERTURE DE LA MODALE
// ===================================================================

function openModal(projectId) {
    const modal = document.getElementById('projectModal');
    const details = projectDetails[projectId];
    const card = document.querySelector(`.project-card[data-project-id="${projectId}"]`);

    if (!details || !card) return;

    // Récupérer la langue actuelle pour la description
    const lang = localStorage.getItem('lang') || 'fr';
    const t = translations[lang] || translations.fr;
    const descKey = `proj${projectId}desc`;
    
    currentProjectId = projectId;
    currentSlideIndex = 0; 
    
    // Remplir les détails du projet
    document.getElementById('modalTitle').textContent = t[`proj${projectId}title`];
    document.getElementById('modalDescription').textContent = t[descKey];

    // Gérer le bouton d'action
    const actionBtn = document.getElementById('modalActionBtn');
    actionBtn.style.display = 'block'; 

    if (details.download) {
        actionBtn.textContent = t.modalDownload;
        actionBtn.dataset.action = 'download';
        actionBtn.dataset.link = details.download;
    } else if (details.link) {
        actionBtn.textContent = t.modalVisit;
        actionBtn.dataset.action = 'link';
        actionBtn.dataset.link = details.link;
    } else {
        actionBtn.style.display = 'none';
        actionBtn.removeAttribute('data-action');
        actionBtn.removeAttribute('data-link');
    }

    // Gérer les tags
    const tagsContainer = document.getElementById('modalTags');
    tagsContainer.innerHTML = details.languages.map(tag => `<span class="tag">${tag}</span>`).join('');

    // Gérer le carrousel
    const images = details.images || [];
    const slidesContainer = document.getElementById('slides-container');
    slidesContainer.innerHTML = '';

    if (images.length > 0) {
        // Crée toutes les slides
        images.forEach(src => {
            const slideDiv = document.createElement('div');
            slideDiv.className = 'slide';
            slideDiv.innerHTML = `<img src="${src}" alt="Project image" />`;
            slidesContainer.appendChild(slideDiv);
        });

        // Met à jour la largeur du conteneur des slides pour la translation CSS
        slidesContainer.style.width = `${images.length * 100}%`;

        // Montre/cache les flèches et points si plus d'une image
        const hasMultipleImages = images.length > 1;
        document.querySelector('.carousel-container .prev').style.display = hasMultipleImages ? 'block' : 'none';
        document.querySelector('.carousel-container .next').style.display = hasMultipleImages ? 'block' : 'none';
        document.getElementById('dot-container').style.display = hasMultipleImages ? 'block' : 'none';
        
        showSlides(0); 
    }


    modal.classList.add('active');
}


// ===================================================================
// Initialisation de la page et gestion des filtres
// ===================================================================

document.addEventListener('DOMContentLoaded', () => {
    // Récupérer tous les éléments nécessaires
    const filterButtons = document.querySelectorAll('#project-filters button');
    const statSegments = document.querySelectorAll('.stat-segment');
    const projectCards = document.querySelectorAll('.project-card');

    // Fonction de filtrage
    function updateFilter(filter) {
        filterButtons.forEach(btn => {
            if (btn.getAttribute('data-filter') === filter) {
                btn.classList.add('active');
            } else {
                btn.classList.remove('active');
            }
        });

        statSegments.forEach(segment => {
            segment.classList.remove('active', 'inactive');
            if (filter === 'all') {
                segment.classList.add('active');
            } else if (
                (filter === 'python' && segment.classList.contains('stat-python')) ||
                (filter === 'html' && segment.classList.contains('stat-html')) ||
                (filter === 'php' && segment.classList.contains('stat-php')) ||
                (filter === 'js' && segment.classList.contains('stat-js'))
            ) {
                segment.classList.add('active');
            } else {
                segment.classList.add('inactive');
            }
        });
        
        projectCards.forEach(card => {
            const category = card.getAttribute('data-category');
            
            if (filter === 'all' || category === filter) {
                card.style.display = 'block'; 
            } else {
                card.style.display = 'none';
            }
        });
    }

    // Écouteurs pour les boutons de filtre
    filterButtons.forEach(btn => {
        btn.addEventListener('click', () => {
            const filter = btn.getAttribute('data-filter');
            updateFilter(filter);
        });
    });

    // Appliquer le filtre initial
    updateFilter('all');

    // Gestion de la langue
    const langSelect = document.getElementById("langSelect");
    const savedLang = localStorage.getItem("lang") || "fr";
    if (langSelect) {
        langSelect.value = savedLang;
        langSelect.addEventListener("change", e => {
            const lang = e.target.value;
            localStorage.setItem("lang", lang);
            applyText(lang);
        });
    }

    applyText(savedLang);

    // Écouteurs pour les cartes de projet
    projectCards.forEach(card => {
        card.addEventListener('click', () => {
            // openModal(projectId) prend l'ID du projet
            openModal(card.dataset.projectId);
        });
    });

    // Écouteur pour fermer la modale en cliquant à l'extérieur
    window.addEventListener('click', e => {
        if (e.target === document.getElementById('projectModal')) {
            closeModal();
        }
    });

    // Mise à jour de l'année
    const yearEl = document.getElementById('currentYear');
    if (yearEl) yearEl.textContent = new Date().getFullYear();
});