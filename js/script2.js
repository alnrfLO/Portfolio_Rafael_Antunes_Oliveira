// Traductions fusionnées avec titres, textes et descriptions des projets
const translations = {
  fr: {
    navAccueil: "Accueil",
    navProjets: "Projets",
    navContact: "Contact",
    navAPropos: "À propos",
    navInfo: "Info",
    navCV: "CV",

    proj1title: "Script Python snake",
    proj1text: "Clicker pour Télécharger un fichier.zip contenant le Snake.",
    proj2title: "Script Python Tetris",
    proj2text: "Clicker pour Télécharger un fichier.zip contenant le Tetris",
    proj3title: "Script Python Pong",
    proj3text: "Clicker pour Télécharger un fichier.zip contenant le Pong",
    proj4title: "Script Python TicTacToe",
    proj4text: "Clicker pour Télécharger un fichier.zip contenant le TicTacToe.",
    proj5title: "Site HTML Responsive",
    proj5text: "Site web responsive et accessible réalisé en HTML/CSS/PHP.",
    proj6title: "Jeu en JS",
    proj6text: "Mini-jeu réalisé avec JavaScript.",
    proj7title: "Projet PHP", 
    proj7text: "Projets de développement utilisant PHP.", 

    proj1desc: "Un jeu de serpent classique développé en Python avec Pygame. Le joueur contrôle un serpent qui grandit à chaque nourriture consommée. Le jeu se termine si le serpent se heurte à un mur ou à lui-même.",
    proj2desc: "Une implémentation du jeu Tetris en Python. Les pièces tombent du haut et le joueur doit les positionner pour remplir des lignes. Chaque ligne complète est supprimée et rapporte des points.",
    proj3desc: "Le jeu Pong classique en Python. Deux joueurs contrôlent des raquettes pour faire rebondir une balle. C'est un jeu multijoueur simple et addictif.",
    proj4desc: "Le jeu du Morpion (Tic-Tac-Toe) en Python. Jouez contre l'ordinateur avec une intelligence artificielle simple. C'est un projet pédagogique pour apprendre les algorithmes de base.",
    proj5desc: "Un site web professionnel et responsive réalisé dans le cadre du projet SAE203. Accessible sur tous les appareils (desktop, tablet, mobile) avec un design moderne et épuré.",
    proj6desc: "Un mini-jeu interactif créé avec JavaScript vanilla. Testez vos réflexes et essayez de battre le meilleur score. Code moderne et optimisé.",
    proj7desc: "Description détaillée du projet PHP.", 

    modalDownload: "Télécharger",
    modalVisit: "Visiter",
    modalClose: "Fermer",
    
    // TRADUCTIONS FOOTER AJOUTÉES
    allRightsReserved: "Tous droits réservés",
    footerMentions: "Mentions Légales"
  },
  en: {
    navAccueil: "Home",
    navProjets: "Projects",
    navContact: "Contact",
    navAPropos: "About",
    navInfo: "Info",
    navCV: "CV",

    proj1title: "Python Snake Script",
    proj1text: "Click to download a .zip file containing the Snake game.",
    proj2title: "Python Tetris Script",
    proj2text: "Click to download a .zip file containing the Tetris game.",
    proj3title: "Python Pong Script",
    proj3text: "Click to download a .zip file containing the Pong game.",
    proj4title: "Python TicTacToe Script",
    proj4text: "Click to download a .zip file containing the TicTacToe game.",
    proj5title: "Responsive HTML Website",
    proj5text: "Responsive and accessible site made with HTML/CSS/PHP.",
    proj6title: "JS Game",
    proj6text: "Mini-game made with JavaScript.",
    proj7title: "PHP Project", 
    proj7text: "Development projects using PHP.", 


    proj1desc: "A classic Snake game developed in Python with Pygame. The player controls a snake that grows with each food eaten. The game ends if the snake hits a wall or itself.",
    proj2desc: "An implementation of Tetris in Python. Pieces fall from the top, and the player must position them to complete lines. Each completed line is removed and gives points.",
    proj3desc: "The classic Pong game in Python. Two players control paddles to bounce a ball. It's a simple and addictive multiplayer game.",
    proj4desc: "Tic-Tac-Toe in Python. Play against the computer with a simple AI. This is an educational project to learn basic algorithms.",
    proj5desc: "A professional and responsive website made for the SAE203 project. Accessible on all devices (desktop, tablet, mobile) with a modern, clean design.",
    proj6desc: "An interactive mini-game created with vanilla JavaScript. Test your reflexes and try to beat the high score. Modern and optimized code.",
    proj7desc: "Detailed description of the PHP project.", 

    modalDownload: "Download",
    modalVisit: "Visit",
    modalClose: "Close",
    
    // TRADUCTIONS FOOTER AJOUTÉES
    allRightsReserved: "All rights reserved",
    footerMentions: "Legal Notice"
  },
  pt: {
    navAccueil: "Início",
    navProjets: "Projetos",
    navContact: "Contato",
    navAPropos: "Sobre",
    navInfo: "Info",
    navCV: "CV",

    proj1title: "Script Python Snake",
    proj1text: "Clique para baixar um arquivo .zip contendo o jogo Snake.",
    proj2title: "Script Python Tetris",
    proj2text: "Clique para baixar um arquivo .zip contendo o jogo Tetris.",
    proj3title: "Script Python Pong",
    proj3text: "Clique para baixar um arquivo .zip contendo o jogo Pong.",
    proj4title: "Script Python TicTacToe",
    proj4text: "Clique para baixar um arquivo .zip contendo o jogo TicTacToe.",
    proj5title: "Site HTML Responsivo",
    proj5text: "Site responsivo e acessível feito com HTML/CSS/PHP.",
    proj6title: "Jogo JS",
    proj6text: "Mini-jogo feito com JavaScript.",
    proj7title: "Projeto PHP", 
    proj7text: "Projetos de desenvolvimento usando PHP.", 

    proj1desc: "Um jogo clássico de Snake desenvolvido em Python com Pygame. O jogador controla uma cobra que cresce a cada comida consumida. O jogo termina se a cobra bater em uma parede ou em si mesma.",
    proj2desc: "Uma implementação do jogo Tetris em Python. As peças caem do topo e o jogador deve posicioná-las para completar linhas. Cada linha completa é removida e gera pontos.",
    proj3desc: "O jogo clássico Pong em Python. Dois jogadores controlam as raquetes para rebater a bola. É um jogo multiplayer simples e viciante.",
    proj4desc: "O jogo da velha (Tic-Tac-Toe) em Python. Jogue contra o computador com uma IA simples. É um projeto educacional para aprender algoritmos básicos.",
    proj5desc: "Um site profissional e responsivo feito para o projeto SAE203. Acessível em todos os dispositivos (desktop, tablet, mobile) com design moderno e limpo.",
    proj6desc: "Um mini-jogo interativo criado com JavaScript vanilla. Teste seus reflexos e tente bater o recorde. Código moderno e otimizado.",
    proj7desc: "Descrição detalhada do projeto PHP.", 

    modalDownload: "Baixar",
    modalVisit: "Visitar",
    modalClose: "Fechar",
    
    // TRADUCTIONS FOOTER AJOUTÉES
    allRightsReserved: "Todos os direitos reservados",
    footerMentions: "Aviso Legal" // Corrigé
  }
};

// ⚡ Project details pour le modal
const projectDetails = {
  1: { image: "../img/snake.png", languages: ["Python", "Pygame"], download: "../downloads/snake.zip" },
  2: { image: "../img/tetris.png", languages: ["Python", "Pygame"], download: "../downloads/Tetris.zip" },
  3: { image: "../img/pong.png", languages: ["Python", "Pygame"], download: "../downloads/Pong.zip" },
  4: { image: "../img/tictactoe.png", languages: ["Python"], download: "../downloads/TicTacToe.zip" },
  5: { image: "../img/SAE203.png", languages: ["HTML", "CSS", "PHP"], link: "http://81.194.40.26/~antunes--oliveira/SAE203/" },
  6: { image: "../img/jeu-js.png", languages: ["JavaScript", "HTML", "CSS"], link: "../projets/jeu-js.html" },
  7: { image: "../img/php_project.png", languages: ["PHP","CSS"], link: "../projets/" } 
};


function applyText(lang) {
  const t = translations[lang];
  document.querySelectorAll('[data-translate]').forEach(el => {
    const key = el.getAttribute('data-translate');
    if (t[key]) el.textContent = t[key];
  });

  // Mise à jour de la boucle pour inclure le projet 7 (i <= 7)
  for (let i = 1; i <= 7; i++) {
    const titleEl = document.getElementById(`proj${i}title`);
    const textEl = document.getElementById(`proj${i}text`);
    if (titleEl && t[`proj${i}title`]) titleEl.textContent = t[`proj${i}title`];
    if (textEl && t[`proj${i}text`]) textEl.textContent = t[`proj${i}text`];
  }
}


function openModal(projectId) {
  const project = projectDetails[projectId];
  if (!project) return;

  const lang = document.getElementById("langSelect").value || "fr";
  const t = translations[lang];

  document.getElementById('modalTitle').textContent = t[`proj${projectId}title`];
  document.getElementById('modalDescription').textContent = t[`proj${projectId}desc`];

  const imgEl = document.getElementById('modalImage');
  if (project.image) {
    imgEl.src = project.image;
    imgEl.style.display = 'block';
  } else imgEl.style.display = 'none';

  const tagsContainer = document.getElementById('modalTags');
  tagsContainer.innerHTML = '';
  project.languages.forEach(langTag => {
    const span = document.createElement('span');
    span.className = 'tag';
    span.textContent = langTag;
    tagsContainer.appendChild(span);
  });

  const actionBtn = document.getElementById('modalActionBtn');
  if (project.download) {
    actionBtn.textContent = t.modalDownload;
    actionBtn.dataset.action = 'download';
    actionBtn.dataset.link = project.download;
  } else if (project.link) {
    actionBtn.textContent = t.modalVisit;
    actionBtn.dataset.action = 'link';
    actionBtn.dataset.link = project.link;
  }

  const closeBtn = document.querySelector('.modal-btn.secondary');
  if (closeBtn) closeBtn.textContent = t.modalClose;

  document.getElementById('projectModal').classList.add('active');
}

function closeModal() {
  document.getElementById('projectModal').classList.remove('active');
}

function handleModalAction() {
  const btn = document.getElementById('modalActionBtn');
  if (btn.dataset.action === 'download') {
    const a = document.createElement('a');
    a.href = btn.dataset.link;
    a.download = '';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
  } else if (btn.dataset.action === 'link') {
    window.location.href = btn.dataset.link;
  }
}


document.addEventListener('DOMContentLoaded', () => {
  const langSelect = document.getElementById("langSelect");
  const savedLang = localStorage.getItem("lang") || "fr";
  if (langSelect) {
    langSelect.value = savedLang;
    langSelect.addEventListener("change", e => {
      const lang = e.target.value;
      localStorage.setItem("lang", lang);
      applyText(lang);
    });
  }

  applyText(savedLang);

  // Project cards
  document.querySelectorAll('.project-card').forEach(card => {
    card.addEventListener('click', () => {
      openModal(card.dataset.projectId);
    });
  });

  // Modal click outside
  window.addEventListener('click', e => {
    const modal = document.getElementById('projectModal');
    if (e.target === modal) closeModal();
  });

  // Set current year
  const yearEl = document.getElementById('currentYear');
  if (yearEl) yearEl.textContent = new Date().getFullYear();
});